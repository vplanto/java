# –ü—Ä–∞–∫—Ç–∏–∫—É–º 9: –ù–µ —Å—Ç–≤–æ—Ä—é–π—Ç–µ –ø–æ—Ç–æ–∫–∏ –≤—Ä—É—á–Ω—É\! –°–∏–ª–∞ ExecutorService

## –í—Å—Ç—É–ø

–ü—Ä–∏–≤—ñ—Ç\! –ù–∞ –º–∏–Ω—É–ª–∏—Ö –∑–∞–Ω—è—Ç—Ç—è—Ö –º–∏ –Ω–∞–≤—á–∏–ª–∏—Å—è —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –ø–æ—Ç–æ–∫–∏ (`new Thread()`) —Ç–∞ —Å–∏–Ω—Ö—Ä–æ–Ω—ñ–∑—É–≤–∞—Ç–∏ —ó—Ö (`synchronized`). –¢–µ–ø–µ—Ä –Ω–∞—Å—Ç–∞–≤ —á–∞—Å –¥—ñ–∑–Ω–∞—Ç–∏—Å—è, —á–æ–º—É –≤ —Ä–µ–∞–ª—å–Ω–∏—Ö –ø—Ä–æ—î–∫—Ç–∞—Ö —Ç–∞–∫... **–º–∞–π–∂–µ –Ω—ñ–∫–æ–ª–∏ –Ω–µ —Ä–æ–±–ª—è—Ç—å**.
(–¶–µ–π –ø—Ä–∞–∫—Ç–∏–∫—É–º —î –ª–æ–≥—ñ—á–Ω–∏–º –ø—Ä–æ–¥–æ–≤–∂–µ–Ω–Ω—è–º [–õ–µ–∫—Ü—ñ—ó 6](06_threads.md), –¥–µ –º–∏ –æ–±–≥–æ–≤–æ—Ä—é–≤–∞–ª–∏ –ø—Ä–æ–±–ª–µ–º–∏ –±–∞–≥–∞—Ç–æ–ø–æ—Ç–æ–∫–æ–≤–æ—Å—Ç—ñ).

–ß–æ–º—É? –¢–æ–º—É —â–æ —Ä—É—á–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–æ—Ç–æ–∫–∞–º–∏ ‚Äî —Ü–µ –ø—Ä—è–º–∏–π —à–ª—è—Ö –¥–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏.

**–ù–∞—à–∞ –º–µ—Ç–∞ —Å—å–æ–≥–æ–¥–Ω—ñ:** –ù–∞–æ—á–Ω–æ –ø–æ–±–∞—á–∏—Ç–∏, —á–æ–º—É `new Thread()` ‚Äî —Ü–µ –ø–æ–≥–∞–Ω–æ, —ñ —Å—Ç–≤–æ—Ä–∏—Ç–∏ **–∫—ñ–Ω—Ü–µ–≤–∏–π –ø—Ä–æ–¥—É–∫—Ç** ‚Äî —Å–∏–º—É–ª—è—Ç–æ—Ä —Å–µ—Ä–≤–µ—Ä–∞, —è–∫–∏–π –æ–±—Ä–æ–±–ª—è—î —Å–æ—Ç–Ω—ñ –∑–∞–ø–∏—Ç—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ ‚Äî **–ü—É–ª–∏ –ü–æ—Ç–æ–∫—ñ–≤ (Thread Pools)**.

-----

## "–õ—é–¥—Å—å–∫–∏–π —Ñ–æ–∫—É—Å": –í–æ–ª–æ–Ω—Ç–µ—Ä—Å—å–∫–∏–π —Ö–∞–æ—Å

–£—è–≤—ñ—Ç—å, —â–æ –º–∏ —Å—Ç–≤–æ—Ä–∏–ª–∏ —Å–∞–π—Ç –¥–ª—è –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—å–∫–æ–≥–æ –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–æ–≥–æ —Ü–µ–Ω—Ç—Ä—É. –£ –≥–æ–¥–∏–Ω–∏ –ø—ñ–∫ –Ω–∞ —Å–∞–π—Ç –æ–¥–Ω–æ—á–∞—Å–Ω–æ –Ω–∞–¥—Ö–æ–¥–∏—Ç—å 1000 –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ —Å–µ–∫—É–Ω–¥—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, "–ø–æ—Ç—Ä—ñ–±–Ω–∞ –¥–æ–ø–æ–º–æ–≥–∞" –∞–±–æ "—Ö–æ—á—É –∑–∞–¥–æ–Ω–∞—Ç–∏—Ç–∏").

**–ü—ñ–¥—Ö—ñ–¥ 1: "–ù–∞—ó–≤–Ω–∏–π" (`new Thread()`)**
–ù–∞ –∫–æ–∂–µ–Ω –∑–∞–ø–∏—Ç –º–∏ –Ω–∞–π–º–∞—î–º–æ –Ω–æ–≤–æ–≥–æ –≤–æ–ª–æ–Ω—Ç–µ—Ä–∞ (—Å—Ç–≤–æ—Ä—é—î–º–æ `new Thread()`).

  * **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ó–∞ 5 —Å–µ–∫—É–Ω–¥ —É –Ω–∞—Å 5000 –≤–æ–ª–æ–Ω—Ç–µ—Ä—ñ–≤. –í–æ–Ω–∏ –º–∏—Ç—Ç—î–≤–æ –≤–∏—á–µ—Ä–ø—É—é—Ç—å —É—Å—ñ —Ä–µ—Å—É—Ä—Å–∏ —Ü–µ–Ω—Ç—Ä—É (–º—ñ—Å—Ü—è, –∫–æ–º–ø'—é—Ç–µ—Ä–∏, –∫–∞–≤—É). –ú–µ–Ω–µ–¥–∂–µ—Ä–∏ –Ω–µ –≤—Å—Ç–∏–≥–∞—é—Ç—å —ó—Ö –∫–æ–æ—Ä–¥–∏–Ω—É–≤–∞—Ç–∏. –ù–∞—Å—Ç–∞—î –ø–æ–≤–Ω–∏–π —Ö–∞–æ—Å, —ñ —Å–∏—Å—Ç–µ–º–∞ "–ª—è–≥–∞—î".

**–ü—ñ–¥—Ö—ñ–¥ 2: "–ü—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π" (Thread Pool)**
–£ –Ω–∞—Å —î "–∑–º—ñ–Ω–∞" –∑ 10 –¥–æ—Å–≤—ñ–¥—á–µ–Ω–∏—Ö –≤–æ–ª–æ–Ω—Ç–µ—Ä—ñ–≤, —è–∫—ñ –ø—Ä–∞—Ü—é—é—Ç—å –Ω–æ–Ω-—Å—Ç–æ–ø (—Ü–µ –Ω–∞—à **–ø—É–ª –ø–æ—Ç–æ–∫—ñ–≤**).

  * **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£—Å—ñ 1000 –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ —Å–µ–∫—É–Ω–¥—É –ø–æ—Ç—Ä–∞–ø–ª—è—é—Ç—å —É **—á–µ—Ä–≥—É (Queue)**. 10 –≤–æ–ª–æ–Ω—Ç–µ—Ä—ñ–≤ —à–≤–∏–¥–∫–æ —Ä–æ–∑–≥—Ä—ñ–±–∞—é—Ç—å —Ü—é —á–µ—Ä–≥—É –æ–¥–∏–Ω –∑–∞ –æ–¥–Ω–∏–º. –†–æ–±–æ—Ç–∞ –π–¥–µ —Å—Ç–∞–±—ñ–ª—å–Ω–æ, –∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–æ, –±–µ–∑ —Ö–∞–æ—Å—É.

-----

## –ü—Ä–æ–±–ª–µ–º–∞: –ß–æ–º—É `new Thread()` ‚Äî —Ü–µ —à–ª—è—Ö –¥–æ –∫–∞—Ç–∞—Å—Ç—Ä–æ—Ñ–∏

–î–∞–≤–∞–π—Ç–µ –ø–æ–¥–∏–≤–∏–º–æ—Å—å –Ω–∞ "–Ω–∞—ó–≤–Ω–∏–π" –ø—ñ–¥—Ö—ñ–¥ —É –∫–æ–¥—ñ.

**1. –°—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ—Ç–æ–∫—É ‚Äî —Ü–µ –¥–æ—Ä–æ–≥–æ.**
–ö–æ–∂–µ–Ω `new Thread()` ‚Äî —Ü–µ –∑–≤–µ—Ä–Ω–µ–Ω–Ω—è –¥–æ –û–ø–µ—Ä–∞—Ü—ñ–π–Ω–æ—ó –°–∏—Å—Ç–µ–º–∏ –∑ –ø—Ä–æ—Ö–∞–Ω–Ω—è–º "–≤–∏–¥—ñ–ª–∏ –º–µ–Ω—ñ —Ä–µ—Å—É—Ä—Å–∏, —Å—Ç–µ–∫, –ø–∞–º'—è—Ç—å...". –¶–µ –∑–∞–π–º–∞—î —á–∞—Å —ñ —Ä–µ—Å—É—Ä—Å–∏.

**2. –í–∏ –Ω–µ –º–æ–∂–µ—Ç–µ —ó—Ö –∫–æ–Ω—Ç—Ä–æ–ª—é–≤–∞—Ç–∏.**
–Ø–∫—â–æ 5000 –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ –Ω–∞—Ç–∏—Å–Ω—É—Ç—å –∫–Ω–æ–ø–∫—É, –≤–∞—à–∞ –ø—Ä–æ–≥—Ä–∞–º–∞ —Å–ª—É—Ö–Ω—è–Ω–æ —Å–ø—Ä–æ–±—É—î —Å—Ç–≤–æ—Ä–∏—Ç–∏ 5000 –ø–æ—Ç–æ–∫—ñ–≤. –ë—ñ–ª—å—à—ñ—Å—Ç—å —Å–∏—Å—Ç–µ–º –ø—Ä–æ—Å—Ç–æ "–ø–æ–º—Ä—É—Ç—å" –≤—ñ–¥ —Ç–∞–∫–æ–≥–æ –Ω–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è, –æ—Ç—Ä–∏–º–∞–≤—à–∏ `OutOfMemoryError`. –í–∏ –Ω—ñ—è–∫ –Ω–µ –æ–±–º–µ–∂—É—î—Ç–µ –∫—ñ–ª—å–∫—ñ—Å—Ç—å "—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤".

**3. –í–∏ –Ω–µ –ø–µ—Ä–µ–≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç–µ –ø–æ—Ç–æ–∫–∏.**
–ü–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–≤ –∑–∞–≤–¥–∞–Ω–Ω—è (–æ–±—Ä–æ–±–∏–≤ –∑–∞–ø–∏—Ç –∑–∞ 100 –º—ñ–ª—ñ—Å–µ–∫—É–Ω–¥) —ñ "–ø–æ–º–µ—Ä". –ù–∞ –Ω–∞—Å—Ç—É–ø–Ω–∏–π —ñ–¥–µ–Ω—Ç–∏—á–Ω–∏–π –∑–∞–ø–∏—Ç –≤–∏ —Å—Ç–≤–æ—Ä—é—î—Ç–µ *–Ω–æ–≤–∏–π* –ø–æ—Ç—ñ–∫. –¶–µ –≤—Å–µ –æ–¥–Ω–æ, —â–æ –∫–æ–∂–Ω–æ–≥–æ —Ä–∞–∑—É –¥–ª—è –ø–æ—ó–∑–¥–∫–∏ –Ω–∞ —Ç–∞–∫—Å—ñ –±—É–¥—É–≤–∞—Ç–∏ –Ω–æ–≤–∏–π –∞–≤—Ç–æ–º–æ–±—ñ–ª—å.

–û—Å—å —è–∫ –≤–∏–≥–ª—è–¥–∞—î —Ü–µ–π —Ö–∞–æ—Å:

```java
// ServerSimulator_Bad.java
public class ServerSimulator_Bad {

    public static void main(String[] args) {
        System.out.println("–ó–∞–ø—É—Å–∫–∞—î–º–æ '–Ω–∞—ó–≤–Ω–∏–π' —Å–µ—Ä–≤–µ—Ä...");
        
        // –Ü–º—ñ—Ç—É—î–º–æ 1000 –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
        for (int i = 0; i < 1000; i++) {
            // –ù–∞ –ö–û–ñ–ï–ù –∑–∞–ø–∏—Ç —Å—Ç–≤–æ—Ä—é—î–º–æ –ù–û–í–ò–ô –ø–æ—Ç—ñ–∫
            Thread taskThread = new Thread(() -> {
                // –Ü–º—ñ—Ç—É—î–º–æ —Ä–æ–±–æ—Ç—É (–Ω–∞–ø—Ä., –∑–∞–ø–∏—Ç –¥–æ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö)
                try {
                    Thread.sleep(1000); 
                } catch (InterruptedException e) {}
                // System.out.println("–ó–∞–ø–∏—Ç –æ–±—Ä–æ–±–ª–µ–Ω–æ –ø–æ—Ç–æ–∫–æ–º: " + Thread.currentThread().getName());
            });
            taskThread.start();
        }
        
        System.out.println("–°–µ—Ä–≤–µ—Ä '–æ–±—Ä–æ–±–∏–≤' 1000 –∑–∞–ø–∏—Ç—ñ–≤...");
        // –ù–∞—Å–ø—Ä–∞–≤–¥—ñ, –º–∏ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏–ª–∏ 1000 –ø–æ—Ç–æ–∫—ñ–≤, —è–∫—ñ –±–æ—Ä—é—Ç—å—Å—è –∑–∞ CPU
        // —ñ –º–æ–∂—É—Ç—å "–≤–±–∏—Ç–∏" –Ω–∞—à—É —Å–∏—Å—Ç–µ–º—É.
    }
}
```

-----

## –†—ñ—à–µ–Ω–Ω—è: `ExecutorService` ‚Äî –≤–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞ "–≤–æ–ª–æ–Ω—Ç–µ—Ä—ñ–≤"

–ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –∫–µ—Ä—É–≤–∞—Ç–∏ –ø–æ—Ç–æ–∫–∞–º–∏ –≤—Ä—É—á–Ω—É, –º–∏ **–¥–µ–ª–µ–≥—É—î–º–æ** —Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ–º—É —Å–µ—Ä–≤—ñ—Å—É ‚Äî `ExecutorService`.

–ú–∏ –ø—Ä–æ—Å—Ç–æ –∫–∞–∂–µ–º–æ: "–û—Å—å —Ç–æ–±—ñ 10 –ø–æ—Ç–æ–∫—ñ–≤-—Ä–æ–±—ñ—Ç–Ω–∏–∫—ñ–≤ (–Ω–∞—à –ø—É–ª), –∞ –æ—Å—å —Ç–æ–±—ñ —á–µ—Ä–≥–∞ –∑–∞–≤–¥–∞–Ω—å (`Runnable`). –î–∞–ª—ñ —Ä–æ–±–∏ —Å–∞–º".

### –Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ

1.  **–°—Ç–≤–æ—Ä—é—î–º–æ –ø—É–ª:**
    –ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ —Ñ–∞–±—Ä–∏—á–Ω–∏–π –∫–ª–∞—Å `Executors`. –ù–∞–π–ø—Ä–æ—Å—Ç—ñ—à–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç ‚Äî `newFixedThreadPool`.

    ```java
    // –°—Ç–≤–æ—Ä—é—î–º–æ "–∑–º—ñ–Ω—É" –∑ 10 –≤–æ–ª–æ–Ω—Ç–µ—Ä—ñ–≤ (–ø–æ—Ç–æ–∫—ñ–≤)
    int corePoolSize = 10;
    ExecutorService executor = Executors.newFixedThreadPool(corePoolSize);
    ```

2.  **–í—ñ–¥–¥–∞—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è:**
    –ó–∞–º—ñ—Å—Ç—å `new Thread().start()` –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î–º–æ `executor.submit(task)`.

    ```java
    // –ù–∞—à–∞ –∑–∞–¥–∞—á–∞ (—Ç–∞ —Å–∞–º–∞, —â–æ –π —Ä–∞–Ω—ñ—à–µ)
    Runnable task = () -> {
        try {
            Thread.sleep(1000); 
        } catch (InterruptedException e) {}
    };

    // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ —á–µ—Ä–≥—É
    executor.submit(task);
    ```

3.  **–ó–∞–∫—Ä–∏–≤–∞—î–º–æ –ø—É–ª (–í–∞–∂–ª–∏–≤–æ\!):**
    –ö–æ–ª–∏ –≤—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è —Ä–æ–∑–¥–∞–Ω—ñ, –º–∏ –º–∞—î–º–æ "–∑–∞–∫—Ä–∏—Ç–∏" –ø—É–ª, —ñ–Ω–∞–∫—à–µ –ø—Ä–æ–≥—Ä–∞–º–∞ –Ω—ñ–∫–æ–ª–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è.

      * `executor.shutdown();` ‚Äî –º'—è–∫–∞ –∑—É–ø–∏–Ω–∫–∞. –ü—É–ª –ø–µ—Ä–µ—Å—Ç–∞–Ω–µ –ø—Ä–∏–π–º–∞—Ç–∏ –Ω–æ–≤—ñ –∑–∞–≤–¥–∞–Ω–Ω—è, –∞–ª–µ –≤–∏–∫–æ–Ω–∞—î —Ç—ñ, —â–æ –≤–∂–µ —î –≤ —á–µ—Ä–∑—ñ.

### –§—ñ–Ω–∞–ª—å–Ω–∏–π –∫–æ–¥ (–ü—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥)

```java
// ServerSimulator_Good.java
import java.util.concurrent.ExecutorService;
import java.util.concurrent.Executors;

public class ServerSimulator_Good {

    public static void main(String[] args) {
        System.out.println("–ó–∞–ø—É—Å–∫–∞—î–º–æ '–ø—Ä–æ—Ñ–µ—Å—ñ–π–Ω–∏–π' —Å–µ—Ä–≤–µ—Ä...");
        
        // 1. –°—Ç–≤–æ—Ä—é—î–º–æ –ø—É–ª –∑ 10 –ø–æ—Ç–æ–∫—ñ–≤. –ë—ñ–ª—å—à–µ 10 –ø–æ—Ç–æ–∫—ñ–≤ –û–î–ù–û–ß–ê–°–ù–û –Ω–µ –±—É–¥–µ.
        ExecutorService executor = Executors.newFixedThreadPool(10);

        // –Ü–º—ñ—Ç—É—î–º–æ 1000 –æ–¥–Ω–æ—á–∞—Å–Ω–∏—Ö –∑–∞–ø–∏—Ç—ñ–≤
        for (int i = 0; i < 1000; i++) {
            
            Runnable task = () -> {
                // –Ü–º—ñ—Ç—É—î–º–æ —Ä–æ–±–æ—Ç—É
                try {
                    Thread.sleep(1000);
                } catch (InterruptedException e) {}
                // System.out.println("–ó–∞–ø–∏—Ç –æ–±—Ä–æ–±–ª–µ–Ω–æ –ø–æ—Ç–æ–∫–æ–º: " + Thread.currentThread().getName());
            };
            
            // 2. –í—ñ–¥–¥–∞—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è –≤ —á–µ—Ä–≥—É. 
            // Executor —Å–∞–º –≤—ñ–∑—å–º–µ –π–æ–≥–æ, –∫–æ–ª–∏ –æ–¥–∏–Ω –∑ 10 –ø–æ—Ç–æ–∫—ñ–≤ –∑–≤—ñ–ª—å–Ω–∏—Ç—å—Å—è.
            executor.submit(task);
        }
        
        // 3. –ö–∞–∂–µ–º–æ –ø—É–ª—É, —â–æ –Ω–æ–≤–∏—Ö –∑–∞–≤–¥–∞–Ω—å –Ω–µ –±—É–¥–µ.
        executor.shutdown();
        
        System.out.println("–°–µ—Ä–≤–µ—Ä –ø—Ä–∏–π–Ω—è–≤ 1000 –∑–∞–ø–∏—Ç—ñ–≤ –Ω–∞ –æ–±—Ä–æ–±–∫—É...");
        // –ü—Ä–æ–≥—Ä–∞–º–∞ –∑–∞–≤–µ—Ä—à–∏—Ç—å—Å—è —Å–∞–º–∞, –∫–æ–ª–∏ –æ—Å—Ç–∞–Ω–Ω—ñ–π –∑ 10 –ø–æ—Ç–æ–∫—ñ–≤
        // –≤–∏–∫–æ–Ω–∞—î –æ—Å—Ç–∞–Ω–Ω—î –∑–∞–≤–¥–∞–Ω–Ω—è –∑ —á–µ—Ä–≥–∏.
    }
}
```

-----

## –©–æ, —è–∫ –∑–∞–≤–¥–∞–Ω–Ω—é –ø–æ—Ç—Ä—ñ–±–Ω–æ –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç? (`Callable` —Ç–∞ `Future`)

–î–æ—Å—ñ –Ω–∞—à—ñ "–≤–æ–ª–æ–Ω—Ç–µ—Ä–∏" –ø—Ä–æ—Å—Ç–æ –≤–∏–∫–æ–Ω—É–≤–∞–ª–∏ —Ä–æ–±–æ—Ç—É —ñ –Ω—ñ—á–æ–≥–æ –Ω–µ –ø–æ–≤–µ—Ä—Ç–∞–ª–∏ (`Runnable` –º–∞—î –º–µ—Ç–æ–¥ `void run()`). –ê–ª–µ —â–æ, —è–∫ –Ω–∞–º –ø–æ—Ç—Ä—ñ–±–Ω–æ, —â–æ–± –ø–æ—Ç—ñ–∫ –≤–∏–∫–æ–Ω–∞–≤ —Å–∫–ª–∞–¥–Ω–µ –æ–±—á–∏—Å–ª–µ–Ω–Ω—è —ñ **–ø–æ–≤–µ—Ä–Ω—É–≤ –Ω–∞–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç**?

–ù–∞–ø—Ä–∏–∫–ª–∞–¥, –Ω–∞—à –≤–æ–ª–æ–Ω—Ç–µ—Ä—Å—å–∫–∏–π —Ü–µ–Ω—Ç—Ä —Ö–æ—á–µ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ –∑–∞–≥–∞–ª—å–Ω—É –ø–æ—Ç—Ä–µ–±—É –≤ –º–µ–¥–∏–∫–∞–º–µ–Ω—Ç–∞—Ö, –æ–ø–∏—Ç–∞–≤—à–∏ 10 —Ä—ñ–∑–Ω–∏—Ö —Å–∫–ª–∞–¥—ñ–≤ –æ–¥–Ω–æ—á–∞—Å–Ω–æ. –ö–æ–∂–Ω–µ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è ‚Äî —Ü–µ –æ–∫—Ä–µ–º–µ –∑–∞–≤–¥–∞–Ω–Ω—è, —è–∫–µ –º–∞—î –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ —á–∏—Å–ª–æ.

–î–ª—è —Ü—å–æ–≥–æ —ñ—Å–Ω—É—î –ø–∞—Ä–∞ `Callable` —Ç–∞ `Future`.

1.  **`Callable<V>`:** –¶–µ —è–∫ `Runnable`, –∞–ª–µ –∑ –¥–≤–æ–º–∞ –≤—ñ–¥–º—ñ–Ω–Ω–æ—Å—Ç—è–º–∏:

      * –ô–æ–≥–æ –º–µ—Ç–æ–¥ `call()` **–ø–æ–≤–µ—Ä—Ç–∞—î –∑–Ω–∞—á–µ–Ω–Ω—è** (—Ç–∏–ø—É `V`, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ `Callable<Integer>`).
      * –í—ñ–Ω **–º–æ–∂–µ –∫–∏–¥–∞—Ç–∏ –≤–∏–Ω—è—Ç–æ–∫** (`throws Exception`), —â–æ –∑–Ω–∞—á–Ω–æ —Å–ø—Ä–æ—â—É—î –æ–±—Ä–æ–±–∫—É –ø–æ–º–∏–ª–æ–∫.

2.  **`Future<V>`:** –¶–µ "–æ–±—ñ—Ü—è–Ω–∫–∞" –∞–±–æ "–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä" –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—É, —è–∫–∏–π *—â–µ –Ω–µ –≥–æ—Ç–æ–≤–∏–π*. –ö–æ–ª–∏ –≤–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—î—Ç–µ `Callable` –≤ `ExecutorService`, –≤—ñ–Ω –Ω–µ–≥–∞–π–Ω–æ –ø–æ–≤–µ—Ä—Ç–∞—î –≤–∞–º `Future`. –í–∏ –º–æ–∂–µ—Ç–µ —Ç—Ä–∏–º–∞—Ç–∏ —Ü–µ–π –æ–±'—î–∫—Ç —É —Å–µ–±–µ, –∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑ –Ω—å–æ–≥–æ –æ—Ç—Ä–∏–º–∞—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ.

### –Ø–∫ —Ü–µ –≤–∏–≥–ª—è–¥–∞—î –Ω–∞ –ø—Ä–∞–∫—Ç–∏—Ü—ñ

–î–∞–≤–∞–π—Ç–µ —Å–∏–º—É–ª—é—î–º–æ –Ω–∞—à –ª–æ–≥—ñ—Å—Ç–∏—á–Ω–∏–π —Ü–µ–Ω—Ç—Ä, —è–∫–∏–π –ø–∞—Ä–∞–ª–µ–ª—å–Ω–æ –æ–ø–∏—Ç—É—î 3 —Å–∫–ª–∞–¥–∏.

```java
// AidCalculator.java (–ù–∞—à–µ –∑–∞–≤–¥–∞–Ω–Ω—è, —â–æ –ø–æ–≤–µ—Ä—Ç–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç)
import java.util.concurrent.Callable;
import java.util.concurrent.ThreadLocalRandom;

// Callable<Integer> –æ–∑–Ω–∞—á–∞—î, —â–æ —Ü–µ–π –ø–æ—Ç—ñ–∫ –ø–æ–≤–µ—Ä–Ω–µ —Ü—ñ–ª–µ —á–∏—Å–ª–æ
public class AidCalculator implements Callable<Integer> {
    
    private String warehouseName;

    public AidCalculator(String warehouseName) {
        this.warehouseName = warehouseName;
    }

    @Override
    public Integer call() throws Exception {
        // –Ü–º—ñ—Ç—É—î–º–æ —Å–∫–ª–∞–¥–Ω—É —Ä–æ–±–æ—Ç—É (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –∑–∞–ø–∏—Ç –¥–æ –ë–î —Å–∫–ª–∞–¥—É)
        System.out.println("üßÆ " + warehouseName + ": –ø–æ—á–∏–Ω–∞—é –ø—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫...");
        int processingTime = ThreadLocalRandom.current().nextInt(1000, 5000);
        Thread.sleep(processingTime);
        
        // –Ü–º—ñ—Ç—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        int itemsNeeded = ThreadLocalRandom.current().nextInt(100, 1000);
        System.out.println("‚úÖ " + warehouseName + ": –ø–æ—Ç—Ä—ñ–±–Ω–æ " + itemsNeeded + " –æ–¥.");
        
        // –ü–æ–≤–µ—Ä—Ç–∞—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        return itemsNeeded;
    }
}
```

–ê —Ç–µ–ø–µ—Ä –≥–æ–ª–æ–≤–Ω–∏–π –∫–ª–∞—Å, —è–∫–∏–π –∑–∞–ø—É—Å–∫–∞—î —Ü—ñ –∑–∞–≤–¥–∞–Ω–Ω—è —ñ **–∑–±–∏—Ä–∞—î —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏**:

```java
// LogisticsCenter.java (–ì–æ–ª–æ–≤–Ω–∏–π –∫–ª–∞—Å)
import java.util.concurrent.*;

public class LogisticsCenter {

    public static void main(String[] args) throws Exception {
        ExecutorService executor = Executors.newFixedThreadPool(3);
        System.out.println("üöÄ –¶–µ–Ω—Ç—Ä –ø–æ—á–∏–Ω–∞—î –ø–∞—Ä–∞–ª–µ–ª—å–Ω–µ –æ–ø–∏—Ç—É–≤–∞–Ω–Ω—è —Å–∫–ª–∞–¥—ñ–≤...");

        // 1. –°—Ç–≤–æ—Ä—é—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è
        Callable<Integer> task1 = new AidCalculator("–°–∫–ª–∞–¥ (–ö–∏—ó–≤)");
        Callable<Integer> task2 = new AidCalculator("–°–∫–ª–∞–¥ (–õ—å–≤—ñ–≤)");
        Callable<Integer> task3 = new AidCalculator("–°–∫–ª–∞–¥ (–•–∞—Ä–∫—ñ–≤)");

        // 2. –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –∑–∞–≤–¥–∞–Ω–Ω—è —ñ –û–¢–†–ò–ú–£–Ñ–ú–û "–û–ë–Ü–¶–Ø–ù–ö–ò" (Future)
        Future<Integer> future1 = executor.submit(task1);
        Future<Integer> future2 = executor.submit(task2);
        Future<Integer> future3 = executor.submit(task3);

        // 3. –û—Ç—Ä–∏–º—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏ (—Ç—É—Ç –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è –º–∞–≥—ñ—è)
        // 
        // future.get() - —Ü–µ –ë–õ–û–ö–£–Æ–ß–ê –æ–ø–µ—Ä–∞—Ü—ñ—è.
        // –ì–æ–ª–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ (main) "–∑–∞–≤–∏—Å–Ω–µ" –Ω–∞ —Ü—å–æ–º—É —Ä—è–¥–∫—É,
        // –¥–æ–∫–∏ 'task1' –Ω–µ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–æ–±–æ—Ç—É —ñ –Ω–µ –ø–æ–≤–µ—Ä–Ω–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç.
        int totalNeeded = 0;
        
        System.out.println("‚è≥ –ì–æ–ª–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ —á–µ–∫–∞—î –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑ –ö–∏—î–≤–∞...");
        totalNeeded += future1.get(); // <-- –ë–ª–æ–∫—É—î–º–æ —ñ —á–µ–∫–∞—î–º–æ
        
        System.out.println("‚è≥ –ì–æ–ª–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ —á–µ–∫–∞—î –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑—ñ –õ—å–≤–æ–≤–∞...");
        totalNeeded += future2.get(); // <-- –ë–ª–æ–∫—É—î–º–æ —ñ —á–µ–∫–∞—î–º–æ
        
        System.out.println("‚è≥ –ì–æ–ª–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ —á–µ–∫–∞—î –Ω–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∑ –•–∞—Ä–∫–æ–≤–∞...");
        totalNeeded += future3.get(); // <-- –ë–ª–æ–∫—É—î–º–æ —ñ —á–µ–∫–∞—î–º–æ

        // 4. –í–∏–≤–æ–¥–∏–º–æ —Ñ—ñ–Ω–∞–ª—å–Ω–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        System.out.println("==========================================");
        System.out.println("üìà –ó–ê–ì–ê–õ–¨–ù–ê –ü–û–¢–†–ï–ë–ê: " + totalNeeded + " –æ–¥.");
        System.out.println("==========================================");

        executor.shutdown();
    }
}
```

### –ü–æ–≥–ª—è–¥ —É –º–∞–π–±—É—Ç–Ω—î: `CompletableFuture`

–Ø–∫ –≤–∏ –ø–æ–º—ñ—Ç–∏–ª–∏, `future.get()` **–±–ª–æ–∫—É—î** –Ω–∞—à –≥–æ–ª–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫. –¶–µ –≤–∂–µ –∫—Ä–∞—â–µ, –Ω—ñ–∂ –Ω—ñ—á–æ–≥–æ, –∞–ª–µ –Ω–µ —ñ–¥–µ–∞–ª—å–Ω–æ.

–°—É—á–∞—Å–Ω–∞ Java (8+) –ø—Ä–æ–ø–æ–Ω—É—î –∑–Ω–∞—á–Ω–æ –ø–æ—Ç—É–∂–Ω—ñ—à–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç ‚Äî **`CompletableFuture`**.

–¶–µ –µ–≤–æ–ª—é—Ü—ñ—è `Future`, —è–∫–∞ –¥–æ–∑–≤–æ–ª—è—î –±—É–¥—É–≤–∞—Ç–∏ **–ª–∞–Ω—Ü—é–∂–∫–∏ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–∏—Ö –æ–ø–µ—Ä–∞—Ü—ñ–π** —É –Ω–µ–±–ª–æ–∫—É—é—á–æ–º—É —Å—Ç–∏–ª—ñ. –ó–∞–º—ñ—Å—Ç—å —Ç–æ–≥–æ, —â–æ–± –ø–∏—Ç–∞—Ç–∏ "—Ä–µ–∑—É–ª—å—Ç–∞—Ç –≥–æ—Ç–æ–≤–∏–π?" —ñ —á–µ–∫–∞—Ç–∏ (`get()`), –≤–∏ –∫–∞–∂–µ—Ç–µ: "–û—Å—å, –≤—ñ–∑—å–º–∏ —Ü–µ –∑–∞–≤–¥–∞–Ω–Ω—è, –∞ **–ö–û–õ–ò** –≤–æ–Ω–æ –±—É–¥–µ –≤–∏–∫–æ–Ω–∞–Ω–æ, **–¢–û–î–Ü** –≤—ñ–∑—å–º–∏ –π–æ–≥–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç —ñ –∑—Ä–æ–±–∏ –∑ –Ω–∏–º *–æ—Å—å —Ü–µ*".

```java
// –ü—Ä–∏–∫–ª–∞–¥ —Ñ—ñ–ª–æ—Å–æ—Ñ—ñ—ó CompletableFuture (—Ü–µ –Ω–µ —Ä–æ–±–æ—á–∏–π –∫–æ–¥, –∞ —ñ–ª—é—Å—Ç—Ä–∞—Ü—ñ—è)

// –ù–ï –¢–ê–ö (–±–ª–æ–∫—É—é—á–∏–π —Å—Ç–∏–ª—å):
// Future<String> future = executor.submit(...);
// String result = future.get(); // <- –ß–ï–ö–ê–Ñ–ú–û
// System.out.println(result);

// –ê –¢–ê–ö (–Ω–µ–±–ª–æ–∫—É—é—á–∏–π —Å—Ç–∏–ª—å):
CompletableFuture.supplyAsync(() -> {
    // ... —Ç—É—Ç –≤–∏–∫–æ–Ω—É—î—Ç—å—Å—è —Å–∫–ª–∞–¥–Ω–µ –∑–∞–≤–¥–∞–Ω–Ω—è ...
    return "–û—Å—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç";
})
.thenApply(result -> {
    // ... —Ü–µ–π –±–ª–æ–∫ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è, –ö–û–õ–ò —Ä–µ–∑—É–ª—å—Ç–∞—Ç –±—É–¥–µ –≥–æ—Ç–æ–≤–∏–π ...
    return result.toUpperCase();
})
.thenAccept(finalResult -> {
    // ... –∞ —Ü–µ–π –±–ª–æ–∫ –≤–∏–∫–æ–Ω–∞—î—Ç—å—Å—è –ü–Ü–°–õ–Ø –ø–æ–ø–µ—Ä–µ–¥–Ω—å–æ–≥–æ ...
    System.out.println(finalResult); // –ù–∞–¥—Ä—É–∫—É—î "–û–°–¨ –†–ï–ó–£–õ–¨–¢–ê–¢"
});

// –ì–æ–ª–æ–≤–Ω–∏–π –ø–æ—Ç—ñ–∫ –ø—Ä–∏ —Ü—å–æ–º—É –Ω–µ –±–ª–æ–∫—É—î—Ç—å—Å—è —ñ –º–æ–∂–µ —Ä–æ–±–∏—Ç–∏ —ñ–Ω—à—É —Ä–æ–±–æ—Ç—É
```

–¶–µ –Ω–∞–¥–∑–≤–∏—á–∞–π–Ω–æ –ø–æ—Ç—É–∂–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü—ñ—è, —è–∫–∞ —î –æ—Å–Ω–æ–≤–æ—é —Å—É—á–∞—Å–Ω–æ—ó –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—ó —Ä–æ–∑—Ä–æ–±–∫–∏ –≤ Java.

-----

## –©–æ –¥–∞–ª—ñ? (–Ü–Ω—à—ñ —Ç–∏–ø–∏ –ø—É–ª—ñ–≤)

–ú–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–ª–∏ `newFixedThreadPool` (—Ñ—ñ–∫—Å–æ–≤–∞–Ω–∞ –∫—ñ–ª—å–∫—ñ—Å—Ç—å –ø–æ—Ç–æ–∫—ñ–≤). –ê–ª–µ —ñ—Å–Ω—É—é—Ç—å –π —ñ–Ω—à—ñ:

  * **`newCachedThreadPool`:** "–ï–ª–∞—Å—Ç–∏—á–Ω–∏–π" –ø—É–ª. –°—Ç–≤–æ—Ä—é—î –Ω–æ–≤—ñ –ø–æ—Ç–æ–∫–∏ –∑–∞ –ø–æ—Ç—Ä–µ–±–æ—é —ñ "–≤–±–∏–≤–∞—î" —Ç—ñ, —â–æ –ø—Ä–æ—Å—Ç–æ—é—é—Ç—å. –î–æ–±—Ä–µ –¥–ª—è –≤–µ–ª–∏–∫–æ—ó –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –∫–æ—Ä–æ—Ç–∫–∏—Ö –∑–∞–≤–¥–∞–Ω—å.
  * **`newSingleThreadExecutor`:** –ü—É–ª –∑ –æ–¥–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É. –ì–∞—Ä–∞–Ω—Ç—É—î, —â–æ –≤—Å—ñ –∑–∞–≤–¥–∞–Ω–Ω—è –±—É–¥—É—Ç—å –≤–∏–∫–æ–Ω–∞–Ω—ñ –ø–æ—Å–ª—ñ–¥–æ–≤–Ω–æ, –æ–¥–Ω–µ –∑–∞ –æ–¥–Ω–∏–º, –≤ –æ–¥–Ω–º—É –ø–æ—Ç–æ—Ü—ñ.

-----

## –ö–æ–Ω—Ç—Ä–æ–ª—å–Ω—ñ –ø–∏—Ç–∞–Ω–Ω—è

1.  **–ü—Ä–æ–±–ª–µ–º–∞:** –ù–∞–∑–≤—ñ—Ç—å —Ç—Ä–∏ –≥–æ–ª–æ–≤–Ω—ñ –ø—Ä–∏—á–∏–Ω–∏, —á–æ–º—É `new Thread()` –¥–ª—è –∫–æ–∂–Ω–æ–≥–æ –∑–∞–ø–∏—Ç—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ ‚Äî —Ü–µ –ø–æ–≥–∞–Ω–∞ —ñ–¥–µ—è.
2.  **–ê–Ω–∞–ª–æ–≥—ñ—è:** –ü–æ—è—Å–Ω—ñ—Ç—å —Å–≤–æ—ó–º–∏ —Å–ª–æ–≤–∞–º–∏, —è–∫ "–ø—É–ª –ø–æ—Ç–æ–∫—ñ–≤" –≤–∏—Ä—ñ—à—É—î —Ü—é –ø—Ä–æ–±–ª–µ–º—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –∞–Ω–∞–ª–æ–≥—ñ—é –∑ –∫—É—Ö–Ω–µ—é —Ä–µ—Å—Ç–æ—Ä–∞–Ω—É –∞–±–æ –∫–æ–ª-—Ü–µ–Ω—Ç—Ä–æ–º.
3.  **–†—ñ—à–µ–Ω–Ω—è:** –Ø–∫ –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è –∫–ª–∞—Å, —è–∫–∏–π –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞–ª–∏ –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ø—É–ª–æ–º –ø–æ—Ç–æ–∫—ñ–≤? –Ø–∫—É –∫–æ–º–∞–Ω–¥—É –º–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–ª–∏, —â–æ–± —Å—Ç–≤–æ—Ä–∏—Ç–∏ –ø—É–ª –∑ 5 –ø–æ—Ç–æ–∫—ñ–≤?
4.  **–ó–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è:** –Ø–∫–∞ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ `thread.start()` —Ç–∞ `executor.submit(task)`?
5.  **–ñ–∏—Ç—Ç—î–≤–∏–π —Ü–∏–∫–ª:** –©–æ —Ä–æ–±–∏—Ç—å –∫–æ–º–∞–Ω–¥–∞ `executor.shutdown()` —ñ —á–æ–º—É –≤–æ–Ω–∞ —î –æ–±–æ–≤'—è–∑–∫–æ–≤–æ—é?
6.  **–ü–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤:** –£ —á–æ–º—É –∫–ª—é—á–æ–≤–∞ —Ä—ñ–∑–Ω–∏—Ü—è –º—ñ–∂ `Runnable` —Ç–∞ `Callable`?
7.  **Future:** –Ø–∫—É –ø—Ä–æ–±–ª–µ–º—É –≤–∏—Ä—ñ—à—É—î `Future` —ñ —è–∫–∏–π –π–æ–≥–æ –≥–æ–ª–æ–≤–Ω–∏–π –Ω–µ–¥–æ–ª—ñ–∫ (–ø–æ–≤'—è–∑–∞–Ω–∏–π –∑ –º–µ—Ç–æ–¥–æ–º `get()`)?